var $_CookedConditionalTimeout=!1;!function(v){v(document).ready(function(){var o,i,a,e=v(".cooked-color-field"),t=v("#cooked_recipe_settings").find("select"),n=v("#cooked-recipe-tabs"),d=(v("#cooked-settings-wrap"),v("#cooked_recipe_settings")),c=d.find("input#submit");if($_CookedTooltips=v(".cooked-tooltip"),$_CookedConditionals=v(".cooked-conditional-hidden"),$_CookedSortable=v(".cooked-sortable"),$_CookedRecipeSaveDefault=v(".cooked-layout-save-default"),$_CookedShortcodeField=v(".cooked-shortcode-field"),$_CookedIngredientBuilder=v("#cooked-ingredients-builder"),$_CookedDirectionBuilder=v("#cooked-directions-builder"),$_CookedRecipeGallery=v("#cooked-recipe-image-gallery"),$_CookedNutritionFactsTab=v("#cooked-recipe-tab-content-nutrition"),$_CookedSettingsPanel=v("#cooked-settings-panel"),$_CookedSettingsTabs=v("#cooked-settings-tabs"),e.length&&e.wpColorPicker(),$_CookedSortable.length&&($_CookedSortable.find(".cooked-icon-drag")?$_CookedSortable.sortable({handle:".cooked-icon-drag"}):$_CookedSortable.sortable()),$_CookedRecipeSaveDefault.length){$_CookedRecipeSaveDefault.tooltipster({theme:"tooltipster-light",trigger:"click",animation:"grow",delay:0,speed:200,maxWidth:275,contentAsHTML:!0,interactive:!0,functionReady:function(e,t){v(".cooked-save-default-all").on("click",function(e){e.preventDefault();var i=v(this),t=i.parent(),o=confirm(cooked_js_vars.i18n_confirm_save_default_all),a=v("#_recipe_settings_content"),n=tinymce.get("_recipe_settings_content");if(null===n)var d=a.val();else d=n.getContent();if(o&&!i.hasClass("disabled")){t.find(".button, .button-primary").addClass("disabled");v.post(cooked_js_vars.ajax_url,{action:"cooked_save_default",default_content:d},function(e){v.post(cooked_js_vars.ajax_url,{action:"cooked_get_recipe_ids"},function(e){if(i.removeClass("button-primary").addClass("button"),e){var t=JSON.parse(e),o=Object.keys(t).length;0<o&&cooked_set_default_template(e,o,d)}})})}}),v(".cooked-save-default-new").on("click",function(e){e.preventDefault();var t=v(this),o=t.parent(),i=v("#_recipe_settings_content"),a=tinymce.get("_recipe_settings_content");if(null===a)var n=i.val();else n=a.getContent();if(!t.hasClass("disabled")){o.find(".button, .button-primary").addClass("disabled");v.post(cooked_js_vars.ajax_url,{action:"cooked_save_default",default_content:n},function(e){t.text(cooked_js_vars.i18n_saved),o.find(".button-primary").removeClass("disabled")}).fail(function(e){})}})}});v(".cooked-layout-load-default").on("click",function(e){e.preventDefault();var t=v(this),o=t.parent(),i=confirm(cooked_js_vars.i18n_confirm_load_default),a=v("#_recipe_settings_content"),n=tinymce.get("_recipe_settings_content");if(i&&!t.hasClass("disabled")){o.find(".button, .button-primary").addClass("disabled");v.post(cooked_js_vars.ajax_url,{action:"cooked_load_default"},function(e){null===n?a.val(e):(a.val(e),n.setContent(e)),o.find(".button, .button-primary").removeClass("disabled")}).fail(function(e){o.find(".button, .button-primary").removeClass("disabled")})}})}if(t.length&&t.each(function(){v(this).wrap('<div class="cooked-select-wrapper" />')}),$_CookedTooltips.length&&$_CookedTooltips.tooltipster({theme:"tooltipster-light",animation:"grow",delay:100,speed:200,maxWidth:275,contentAsHTML:!0,interactive:!0}),$_CookedShortcodeField.length&&$_CookedShortcodeField.on("click",function(e){v(this).select()}),$_CookedConditionals.length){var r=[];$_CookedConditionals.each(function(){var e,t=v(this),o=v(this).data("condition"),i=v(this).data("value"),a=v("#"+o);i=!!i&&i.split(" "),e=t.is("li")||t.is("span")?"inline-block":"block",a.is(":checkbox")&&a.is(":checked")||a.is(":radio")&&a.is(":checked")?t.css({display:e}):a.is(":checkbox")&&!a.is(":checked")||a.is(":radio")&&!a.is(":checked")?t.hide():!a.is(":checkbox")&&!i&&a.val()||!a.is(":checkbox")&&i&&-1<v.inArray(a.val(),i)?t.css({display:e}):!a.is(":radio")&&!i&&a.val()||!a.is(":radio")&&i&&-1<v.inArray(a.val(),i)?t.css({display:e}):t.hide(),-1==v.inArray(o,r)&&r.push(o);for(var n=r.length,d=0;d<n;d++)cooked_init_conditional_field(o)})}if(n.length){var l=n.find("li"),s=n.offset().top-32;v(window).on("load scroll",function(){var e=v(window).scrollTop();s<=e?d.addClass("stuck"):d.removeClass("stuck")}),l.on("click",function(e){e.preventDefault(),window.scrollTo(0,0);var t=v(this),o=t.attr("id");o=(o=o.split("cooked-recipe-tab-"))[1],v(".cooked-recipe-tab-content").hide(),v("#cooked-recipe-tab-content-"+o).show(),l.removeClass("active"),t.addClass("active")})}if($_CookedSettingsTabs.length||n.length){var u=Array.prototype.slice.call(document.querySelectorAll(".cooked-switch")),k=Array.prototype.slice.call(document.querySelectorAll(".cooked-switch-red")),_=Array.prototype.slice.call(document.querySelectorAll(".cooked-switch-yellow")),p=Array.prototype.slice.call(document.querySelectorAll(".cooked-switch-gray"));u.forEach(function(e){new Switchery(e,{color:"#00c086",size:"small"})}),k.forEach(function(e){new Switchery(e,{color:"#d44d1f",size:"small"})}),_.forEach(function(e){new Switchery(e,{color:"#ffad18",size:"small"})}),p.forEach(function(e){new Switchery(e,{color:"#aaaaaa",size:"small"})})}if($_CookedSettingsTabs.length){var g,f=window.location.hash,h=$_CookedSettingsTabs.find("li"),m=$_CookedSettingsTabs.offset().top-32;if(v(window).on("load scroll",function(){var e=v(window).scrollTop();m<=e?($_CookedSettingsPanel.addClass("stuck"),v("#cooked-settings-wrap").addClass("is-stuck")):($_CookedSettingsPanel.removeClass("stuck"),v("#cooked-settings-wrap").removeClass("is-stuck"))}),f)g=(g=(g=f).split("#"))[1],$_CookedSettingsTabs.find("li").removeClass("active"),$_CookedSettingsTabs.find('a[href="'+f+'"]').parent().addClass("active"),"migration"==g?c.hide():c.show(),v(".cooked-settings-tab-content").hide(),v("#cooked-settings-tab-content-"+g).show();else g=(g=(g=$_CookedSettingsTabs.find(".active > a").attr("href")).split("#"))[1],v(".cooked-settings-tab-content").hide(),v("#cooked-settings-tab-content-"+g).show();h.on("click",function(e){v(".tab-content").hide();var t=v(this).find("a");$_CookedSettingsTabs.find("li").removeClass("active"),v(this).addClass("active");var o=t.attr("href");"migration"==(o=(o=o.split("#"))[1])?c.hide():c.show(),v(".cooked-settings-tab-content").hide(),v("#cooked-settings-tab-content-"+o).show(),v("#cooked-settings-panel").hasClass("stuck")?window.scrollTo(0,130):window.scrollTo(0,0)})}($_CookedIngredientBuilder.length&&(cooked_reset_ingredient_builder(),$_CookedIngredientBuilder.on("keydown",'input[data-ingredient-part="name"]',function(e){9!==e.keyCode&&13!==e.keyCode||v(this).parents(".cooked-ingredient-block").is(":last-child")&&(e.preventDefault(),v("#cooked-recipe-tab-content-ingredients").find(".cooked-add-ingredient-button").trigger("click"),$_CookedIngredientBuilder.find('.cooked-ingredient-block:last-child input[data-ingredient-part="amount"]').focus())}),$_CookedIngredientBuilder.on("keyup",'input[data-ingredient-part="url"]',function(e){var t=v(this).val(),o=v(this).parents(".recipe-setting-block");t?o.addClass("cooked-has-url"):o.removeClass("cooked-has-url")}),$_CookedIngredientBuilder.parent().on("click",".cooked-add-ingredient-button",function(e){e.preventDefault();var t=$_CookedIngredientBuilder.parent().find(".cooked-ingredient-template").clone().removeClass("cooked-template cooked-ingredient-template").addClass("cooked-ingredient-block");$_CookedIngredientBuilder.append(t),cooked_reset_ingredient_builder()}),$_CookedIngredientBuilder.parent().on("click",".cooked-add-heading-button",function(e){e.preventDefault();var t=$_CookedIngredientBuilder.parent().find(".cooked-heading-template").clone().removeClass("cooked-template cooked-heading-template").addClass("cooked-ingredient-block cooked-ingredient-heading");$_CookedIngredientBuilder.append(t),cooked_reset_ingredient_builder()}),$_CookedIngredientBuilder.parent().on("click",".cooked-delete-ingredient",function(e){e.preventDefault(),v(this).parent().remove(),cooked_reset_ingredient_builder()})),$_CookedDirectionBuilder.length)&&(cooked_reset_direction_builder(),$_CookedDirectionBuilder.parent().on("click",".cooked-add-direction-button",function(e){e.preventDefault();var t=$_CookedDirectionBuilder.parent().find(".cooked-direction-template").clone().removeClass("cooked-template cooked-direction-template").addClass("cooked-direction-block");$_CookedDirectionBuilder.append(t),cooked_reset_direction_builder()}),$_CookedDirectionBuilder.parent().on("click",".cooked-add-heading-button",function(e){e.preventDefault();var t=$_CookedDirectionBuilder.parent().find(".cooked-heading-template").clone().removeClass("cooked-template cooked-heading-template").addClass("cooked-direction-block cooked-direction-heading");$_CookedDirectionBuilder.append(t),cooked_reset_direction_builder()}),$_CookedDirectionBuilder.parent().on("click",".cooked-delete-direction",function(e){e.preventDefault(),v(this).parent().remove(),cooked_reset_direction_builder()}),$_CookedDirectionBuilder.parent().on("click",".remove-image-button",function(e){e.preventDefault(),v(this).parent().removeClass("cooked-has-image"),v(this).parent().find("img").remove(),v(this).parent().find('input[data-direction-part="image"]').val(""),cooked_reset_direction_builder()}),v("body").on("click",".cooked-direction-img-placeholder, .cooked-direction-img",function(e){e.preventDefault(),v(this).parent().find(".direction-image-button").trigger("click")}),v("body").on("click",".direction-image-button",function(e){var t=v(this);i=t.data("id"),e.preventDefault(),o||(o=wp.media.frames.direction_image_frame=wp.media({title:cooked_js_vars.i18n_image_title,button:{text:cooked_js_vars.i18n_image_button},library:{type:"image"}})).on("select",function(){var e=o.state().get("selection").first().toJSON();v("#direction-"+i+"-image-src").attr("src",e.sizes.thumbnail.url).parent().addClass("cooked-has-image"),v('input[name="_recipe_settings[directions]['+i+'][image]"]').val(e.id),v('.direction-image-button[data-id="'+i+'"]').prop("value",cooked_js_vars.i18n_image_change)}),o.open()}));$_CookedRecipeGallery.length&&(cooked_init_gallery_sorting(),v("body").on("click",".cooked-gallery-add-button",function(e){v(this);e.preventDefault(),a||(a=wp.media.frames.gallery_images_frame=wp.media({title:cooked_js_vars.i18n_gallery_image_title,button:{text:cooked_js_vars.i18n_gallery_image_title},library:{type:"image"},multiple:!0})).on("select",function(){var e,t=a.state().get("selection").toJSON();for(var o in t)if(t.hasOwnProperty(o)){var i=t[o];e=i.sizes.thumbnail.url,v("#cooked-recipe-image-gallery").append('<div data-attachment-id="'+i.id+'" class="cooked-recipe-gallery-item"><img src="'+e+'" /><span class="cooked-gallery-item-title">'+i.title+'</span><input type="hidden" name="_recipe_settings[gallery][items][]" value="'+i.id+'" /><a href="#" data-attachment-id="'+i.id+'" class="cooked-gallery-edit-button"><i class="cooked-icon cooked-icon-pencil"></i></a><a href="#" class="remove-image-button"><i class="cooked-icon cooked-icon-times"></i></a></div>')}cooked_init_gallery_sorting()}),a.open()}),v("body").on("click",".cooked-recipe-gallery-item img",function(e){e.preventDefault(),v(this).parent().find(".cooked-gallery-edit-button").trigger("click")}),v("body").on("click",".cooked-gallery-edit-button",function(e){var a=v(this),t=a.data("attachment-id");e.preventDefault();var n=wp.media.frames.gallery_images_frame=wp.media({title:cooked_js_vars.i18n_edit_image_title,button:{text:cooked_js_vars.i18n_edit_image_button},library:{type:"image"},multiple:!1});n.on("open",function(){var e=n.state().get("selection");attachment=wp.media.attachment(t),attachment.fetch(),e.add(attachment?[attachment]:[])}),n.open(),n.on("select",function(){var e,t=n.state().get("selection").toJSON();for(var o in t)if(t.hasOwnProperty(o)){var i=t[o];e=i.sizes.thumbnail.url,a.parent().replaceWith('<div data-attachment-id="'+i.id+'" class="cooked-recipe-gallery-item"><img src="'+e+'" /><span class="cooked-gallery-item-title">'+i.title+'</span><input type="hidden" name="_recipe_settings[gallery][items][]" value="'+i.id+'" /><a href="#" data-attachment-id="'+i.id+'" class="cooked-gallery-edit-button"><i class="cooked-icon cooked-icon-pencil"></i></a><a href="#" class="remove-image-button"><i class="cooked-icon cooked-icon-times"></i></a></div>')}cooked_init_gallery_sorting()})}),$_CookedRecipeGallery.on("click",".remove-image-button",function(e){var t=v(this);i=t.data("id"),e.preventDefault(),i?(v("#direction-"+i+"-image-src").parent().removeClass("cooked-has-image").prop("src",!1),v('input[name="_recipe_settings[directions]['+i+'][image]"]').val(""),v('.direction-image-button[data-id="'+i+'"]').prop("value",cooked_js_vars.i18n_image_title)):t.parent().remove()}));$_CookedNutritionFactsTab.length&&(init_nutrition_facts($_CookedNutritionFactsTab),$_CookedNutritionFactsTab.on("keyup","input",function(e){init_nutrition_facts($_CookedNutritionFactsTab)})),v("#cooked-prep-time").length&&v("#cooked-prep-time,#cooked-cook-time").on("change",function(){cooked_updateTotalTimeValue(parseInt(v("#cooked-prep-time").val()),parseInt(v("#cooked-cook-time").val()))})})}(jQuery);var cooked_recipe_update_counter=0;function cooked_set_default_template(e,i,a){var n=0;if(0<i){var d=jQuery("#cooked-template-progress"),c=d.find(".cooked-progress-bar"),r=jQuery("#cooked-template-progress-text");d.hasClass("cooked-active")||(d.addClass("cooked-active"),r.addClass("cooked-active"),c.css({width:"0%"}));jQuery.post(cooked_js_vars.ajax_url,{action:"cooked_save_default_bulk",recipe_ids:e,default_content:a},function(e){if(e&&"false"!=e&&0!=e){var t=JSON.parse(e),o=Object.keys(t).length;cooked_recipe_update_counter=i-o,n=Math.round(cooked_recipe_update_counter/i*100),c.css({width:n+"%"}),r.text(cooked_recipe_update_counter+" / "+i),cooked_set_default_template(e,i,a)}else jQuery(".cooked-save-default-all").text(cooked_js_vars.i18n_applied),c.css({width:"100%"}),d.removeClass("cooked-active"),r.removeClass("cooked-active").text("")})}}function cooked_updateTotalTimeValue(e,t){var o=e+t;jQuery("#cooked-total-time").val(o)}function cooked_init_gallery_sorting(){jQuery("#cooked-recipe-image-gallery").sortable()}function init_nutrition_facts(e){e.find("input").each(function(){var e=jQuery(this),t=e.attr("id"),o=e.val(),i=jQuery('.cooked-nut-percent[data-labeltype="'+t+'"]').length;if(jQuery('.cooked-nut-label[data-labeltype="'+t+'"]').length)if(o){if(jQuery('.cooked-nut-label[data-labeltype="'+t+'"]').html(o),jQuery('.cooked-nut-label[data-labeltype="'+t+'"]').parents("li").eq(0).show(),jQuery('.cooked-nut-label[data-labeltype="'+t+'"]').parents("p").eq(0).show(),i){var a=jQuery('.cooked-nut-percent[data-labeltype="'+t+'"]'),n=a.data("pdv");n&&(thisPercent=Math.ceil(o/n*100),a.text(thisPercent))}}else jQuery('.cooked-nut-label[data-labeltype="'+t+'"]').html("___ "),jQuery('.cooked-nut-label[data-labeltype="'+t+'"]').parents("li").eq(0).hide(),jQuery('.cooked-nut-label[data-labeltype="'+t+'"]').parents("p").eq(0).hide()})}function cooked_reset_ingredient_builder(){var e=jQuery(".cooked-ingredient-block"),t=0,i=0;e.each(function(){var o=cooked_get_random_int(1e7,99999999);i++;var e=jQuery(this);e.hasClass("cooked-ingredient-heading")||t++,e.find("[data-ingredient-part]").each(function(){var e=jQuery(this);if(""==e.attr("name")){var t=e.data("ingredient-part");e.attr("name","_recipe_settings[ingredients]["+o+"]["+t+"]")}})}),t?jQuery(".cooked-ingredient-headers").show():jQuery(".cooked-ingredient-headers").hide(),i?jQuery("#cooked-ingredients-builder").css({"margin-bottom":"20px"}):jQuery("#cooked-ingredients-builder").css({"margin-bottom":"12px"})}function cooked_reset_direction_builder(){var e=jQuery(".cooked-direction-block"),t=0;e.each(function(){var o=cooked_get_random_int(1e7,99999999);t++,jQuery(this).find("[data-direction-part]").each(function(){var e=jQuery(this);if(""==e.attr("name")){var t=e.data("direction-part");e.attr("name","_recipe_settings[directions]["+o+"]["+t+"]")}(""==e.attr("data-id")&&e.attr("data-id",o),""==e.attr("id"))&&(t=(t=e.data("direction-part")).replace("_","-"),e.attr("id","direction-"+o+"-"+t))})}),t?jQuery("#cooked-directions-builder").css({"margin-bottom":"20px"}):jQuery("#cooked-directions-builder").css({"margin-bottom":"12px"})}function cooked_get_random_int(e,t){return Math.floor(Math.random()*(t-e))+e}function cooked_is_int(e){return!(Math.floor(e)!=e||!$.isNumeric(e))}function cooked_init_conditional_field(e){var i=jQuery("#"+e);i.is(":radio")&&jQuery("body").find("input:radio").on("change",function(){i.is(":checked")||jQuery("body").find("[data-condition='"+e+"']").each(function(){jQuery(this).hide()})}),i.on("change",function(){jQuery("#cooked_recipe_settings").addClass("cooked-loading"),window.clearTimeout($_CookedConditionalTimeout),$_CookedConditionalTimeout=window.setTimeout(function(){jQuery("body").find("[data-condition='"+e+"']").each(function(){var e,t=jQuery(this);e=t.is("li")||t.is("span")?"inline-block":"block";var o=t.data("value");o=!!o&&o.split(" "),i.is(":checkbox")&&i.is(":checked")||i.is(":radio")&&i.is(":checked")?t.css({display:e}):i.is(":checkbox")&&!i.is(":checked")?t.hide():!i.is(":checkbox")&&!o&&i.val()||!i.is(":checkbox")&&o&&-1<jQuery.inArray(i.val(),o)?t.css({display:e}):!i.is(":radio")&&!o&&i.val()||!i.is(":radio")&&o&&-1<jQuery.inArray(i.val(),o)?t.css({display:e}):t.hide()}),jQuery("#cooked_recipe_settings").removeClass("cooked-loading")},25)})}