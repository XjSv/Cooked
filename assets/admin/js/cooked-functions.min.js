var $_CookedConditionalTimeout=!1,cooked_recipe_update_counter=((_=>{_(document).ready(function(){var r,o,t,e,i,n,a,d,c,l=_(".cooked-color-field"),s=_("#cooked_recipe_settings").find("select"),u=_("#cooked-recipe-tabs"),k=(_("#cooked-settings-wrap"),_("#cooked_recipe_settings")),p=k.find("input#submit");$_CookedTooltips=_(".cooked-tooltip"),$_CookedConditionals=_(".cooked-conditional-hidden"),$_CookedSortable=_(".cooked-sortable"),$_CookedRecipeSaveDefault=_(".cooked-layout-save-default"),$_CookedShortcodeField=_(".cooked-shortcode-field"),$_CookedIngredientBuilder=_("#cooked-ingredients-builder"),$_CookedAutoNutritionButton=_(".cooked-auto-nutrition-button"),$_CookedDirectionBuilder=_("#cooked-directions-builder"),$_CookedRecipeGallery=_("#cooked-recipe-image-gallery"),$_CookedNutritionFactsTab=_("#cooked-recipe-tab-content-nutrition"),$_CookedSettingsPanel=_("#cooked-settings-panel"),$_CookedSettingsTabs=_("#cooked-settings-tabs"),l.length&&l.wpColorPicker(),$_CookedSortable.length&&($_CookedSortable.find(".cooked-icon-drag")?$_CookedSortable.sortable({stop:function(e,t){var t=t.item.find("textarea"),o=t.attr("name"),t=t.attr("id");wp.editor.remove(t),wp.editor.initialize(t,{tinymce:{wpautop:!1,toolbar1:"bold,italic,underline,blockquote,strikethrough,bullist,numlist,alignleft,aligncenter,alignright,undo,redo,wp_link_advanced,unlink,fullscreen",toolbar2:"",toolbar3:"",toolbar4:"",height:100,textarea_name:o,plugins:"link lists fullscreen wordpress wplink",setup:function(e){}},quicktags:!0,mediaButtons:!1})}}):$_CookedSortable.sortable()),$_CookedRecipeSaveDefault.length&&($_CookedRecipeSaveDefault.tooltipster({theme:["tooltipster-light","tooltipster-sideTip-cooked"],trigger:"click",animation:"grow",delay:0,speed:200,maxWidth:275,contentAsHTML:!0,interactive:!0,functionReady:function(c,e){_(".cooked-save-default-all").on("click",function(e){e.preventDefault();var o,i=_(this),e=i.data("nonce"),n=i.data("bulk-nonce"),t=i.parent(),a=confirm(cooked_js_vars.i18n_confirm_save_default_all),d=_("#_recipe_settings_content"),r=tinymce.get("_recipe_settings_content");o=null===r?d.val():r.getContent(),a&&!i.hasClass("disabled")&&(t.find(".button, .button-primary").addClass("disabled"),_.post(cooked_js_vars.ajax_url,{action:"cooked_save_default",default_content:o,nonce:e},function(e){_.post(cooked_js_vars.ajax_url,{action:"cooked_get_recipe_ids",nonce:n},function(e){var t;i.removeClass("button-primary").addClass("button"),e&&(t=JSON.parse(e),0<(t=Object.keys(t).length))&&cooked_set_default_template(e,t,o,n,c)})}))}),_(".cooked-save-default-new").on("click",function(e){e.preventDefault();var t=_(this),e=t.data("nonce"),o=t.parent(),i=_("#_recipe_settings_content"),n=tinymce.get("_recipe_settings_content");i=null===n?i.val():n.getContent(),t.hasClass("disabled")||(o.find(".button, .button-primary").addClass("disabled"),_.post(cooked_js_vars.ajax_url,{action:"cooked_save_default",default_content:i,nonce:e},function(e){t.text(cooked_js_vars.i18n_saved),o.find(".button-primary").removeClass("disabled")}).fail(function(e){}))})}}),_(".cooked-layout-load-default").on("click",function(e){e.preventDefault();var e=_(this),t=e.parent(),o=confirm(cooked_js_vars.i18n_confirm_load_default),i=_("#_recipe_settings_content"),n=tinymce.get("_recipe_settings_content");o&&!e.hasClass("disabled")&&(t.find(".button, .button-primary").addClass("disabled"),_.post(cooked_js_vars.ajax_url,{action:"cooked_load_default"},function(e){null===n?i.val(e):(i.val(e),n.setContent(e)),t.find(".button, .button-primary").removeClass("disabled")}).fail(function(e){t.find(".button, .button-primary").removeClass("disabled")}))})),s.length&&s.each(function(){_(this).wrap('<div class="cooked-select-wrapper" />')}),$_CookedTooltips.length&&$_CookedTooltips.tooltipster({theme:["tooltipster-light","tooltipster-sideTip-cooked"],animation:"grow",delay:100,speed:200,maxWidth:275,contentAsHTML:!0,interactive:!0}),$_CookedShortcodeField.length&&$_CookedShortcodeField.on("click",function(e){_(this).select()}),$_CookedConditionals.length&&(r=[],$_CookedConditionals.each(function(){var e=_(this),t=_(this).data("condition"),o=_(this).data("value"),i=_("#"+t),o=!!o&&o.split(" "),n=e.is("li")||e.is("span")?"inline-block":"block";i.is(":checkbox")&&i.is(":checked")||i.is(":radio")&&i.is(":checked")||!(i.is(":checkbox")&&!i.is(":checked")||i.is(":radio")&&!i.is(":checked"))&&(!i.is(":checkbox")&&!o&&i.val()||!i.is(":checkbox")&&o&&-1<_.inArray(i.val(),o)||!i.is(":radio")&&!o&&i.val()||!i.is(":radio")&&o&&-1<_.inArray(i.val(),o))?e.css({display:n}):e.hide(),-1==_.inArray(t,r)&&r.push(t);for(var a=r.length,d=0;d<a;d++)cooked_init_conditional_field(t)})),u.length&&(o=u.find("li"),t=u.offset().top-32,_(window).on("load scroll",function(){var e=_(window).scrollTop();t<=e?k.addClass("stuck"):k.removeClass("stuck")}),o.on("click",function(e){e.preventDefault(),o.removeClass("active"),window.scrollTo(0,0);var e=_(this),t=e.attr("id").split("cooked-recipe-tab-")[1];_(".cooked-recipe-tab-content").hide(),_("#cooked-recipe-tab-content-"+t).show(),e.addClass("active")})),($_CookedSettingsTabs.length||u.length)&&(l=Array.prototype.slice.call(document.querySelectorAll(".cooked-switch")),s=Array.prototype.slice.call(document.querySelectorAll(".cooked-switch-red")),u=Array.prototype.slice.call(document.querySelectorAll(".cooked-switch-yellow")),e=Array.prototype.slice.call(document.querySelectorAll(".cooked-switch-gray")),l.forEach(function(e){new Switchery(e,{color:"#00c086",size:"small"})}),s.forEach(function(e){new Switchery(e,{color:"#d44d1f",size:"small"})}),u.forEach(function(e){new Switchery(e,{color:"#ffad18",size:"small"})}),e.forEach(function(e){new Switchery(e,{color:"#aaaaaa",size:"small"})})),$_CookedSettingsTabs.length&&(l=window.location.hash,s=$_CookedSettingsTabs.find("li"),i=$_CookedSettingsTabs.offset().top-32,_(window).on("load scroll",function(){var e=_(window).scrollTop();i<=e?($_CookedSettingsPanel.addClass("stuck"),_("#cooked-settings-wrap").addClass("is-stuck")):($_CookedSettingsPanel.removeClass("stuck"),_("#cooked-settings-wrap").removeClass("is-stuck"))}),l?(n=(n=(n=l).split("#"))[1],$_CookedSettingsTabs.find("li").removeClass("active"),$_CookedSettingsTabs.find('a[href="'+l+'"]').parent().addClass("active"),"migration"==n?p.hide():p.show()):n=(n=(n=$_CookedSettingsTabs.find(".active > a").attr("href")).split("#"))[1],_(".cooked-settings-tab-content").hide(),_("#cooked-settings-tab-content-"+n).show(),s.on("click",function(e){_(".tab-content").hide();var t=_(this).find("a"),t=($_CookedSettingsTabs.find("li").removeClass("active"),_(this).addClass("active"),t.attr("href"));"migration"==(t=(t=t.split("#"))[1])?p.hide():p.show(),_(".cooked-settings-tab-content").hide(),_("#cooked-settings-tab-content-"+t).show(),_("#cooked-settings-panel").hasClass("stuck")?window.scrollTo(0,130):window.scrollTo(0,0)})),$_CookedIngredientBuilder.length&&(cooked_reset_ingredient_builder(),$_CookedIngredientBuilder.on("keydown",'input[data-ingredient-part="name"]',function(e){9!==e.keyCode&&13!==e.keyCode||_(this).parents(".cooked-ingredient-block").is(":last-child")&&(e.preventDefault(),_("#cooked-recipe-tab-content-ingredients").find(".cooked-add-ingredient-button").trigger("click"),$_CookedIngredientBuilder.find('.cooked-ingredient-block:last-child input[data-ingredient-part="amount"]').focus())}),$_CookedIngredientBuilder.parent().on("click",".cooked-show-heading-element",function(e){e.preventDefault();e=_(this).parent();e.hasClass("cooked-expanded")?e.removeClass("cooked-expanded"):(e.addClass("cooked-expanded"),e.find('input[data-ingredient-part="section_heading_element"]').focus())}),$_CookedAutoNutritionButton.length&&$_CookedIngredientBuilder.on("change",'input[data-ingredient-part="name"]',function(e){var t=!1;$_CookedIngredientBuilder.find('input[data-ingredient-part="name"]').each(function(){if(""!=_(this).val())return!(t=!0)}),t?$_CookedAutoNutritionButton.prop("disabled",!1):$_CookedAutoNutritionButton.prop("disabled",!0)}),$_CookedIngredientBuilder.on("keyup",'input[data-ingredient-part="url"]',function(e){var t=_(this).val(),o=_(this).parents(".recipe-setting-block");t?o.addClass("cooked-has-url"):o.removeClass("cooked-has-url")}),$_CookedIngredientBuilder.parent().on("click",".cooked-add-ingredient-button",function(e){e.preventDefault();e=$_CookedIngredientBuilder.parent().find(".cooked-ingredient-template").clone().removeClass("cooked-template cooked-ingredient-template").addClass("cooked-ingredient-block");$_CookedIngredientBuilder.append(e),cooked_reset_ingredient_builder()}),$_CookedIngredientBuilder.parent().on("click",".cooked-add-heading-button",function(e){e.preventDefault();e=$_CookedIngredientBuilder.parent().find(".cooked-heading-template").clone().removeClass("cooked-template cooked-heading-template").addClass("cooked-ingredient-block cooked-ingredient-heading");$_CookedIngredientBuilder.append(e),cooked_reset_ingredient_builder()}),$_CookedIngredientBuilder.parent().on("click",".cooked-delete-ingredient",function(e){e.preventDefault(),_(this).parent().remove(),cooked_reset_ingredient_builder()})),$_CookedDirectionBuilder.length&&(cooked_reset_direction_builder(),$_CookedDirectionBuilder.parent().on("click",".cooked-show-heading-element",function(e){e.preventDefault();e=_(this).parent();e.hasClass("cooked-expanded")?e.removeClass("cooked-expanded"):(e.addClass("cooked-expanded"),e.find('input[data-direction-part="section_heading_element"]').focus())}),$_CookedDirectionBuilder.parent().on("click",".cooked-add-direction-button",function(e){e.preventDefault();e=$_CookedDirectionBuilder.parent().find(".cooked-direction-template").clone().removeClass("cooked-template cooked-direction-template").addClass("cooked-direction-block");$_CookedDirectionBuilder.append(e),cooked_reset_direction_builder()}),$_CookedDirectionBuilder.parent().on("click",".cooked-add-heading-button",function(e){e.preventDefault();e=$_CookedDirectionBuilder.parent().find(".cooked-heading-template").clone().removeClass("cooked-template cooked-heading-template").addClass("cooked-direction-block cooked-direction-heading");$_CookedDirectionBuilder.append(e),cooked_reset_direction_builder()}),$_CookedDirectionBuilder.parent().on("click",".cooked-delete-direction",function(e){e.preventDefault(),_(this).parent().remove(),cooked_reset_direction_builder()}),$_CookedDirectionBuilder.parent().on("click",".remove-image-button",function(e){e.preventDefault(),_(this).parent().removeClass("cooked-has-image"),_(this).parent().find("img").remove(),_(this).parent().find('input[data-direction-part="image"]').val(""),cooked_reset_direction_builder()}),_("body").on("click",".cooked-direction-img-placeholder, .cooked-direction-img",function(e){e.preventDefault(),_(this).parent().find(".direction-image-button").trigger("click")}),_("body").on("click",".direction-image-button",function(e){var t=_(this);d=t.data("id"),e.preventDefault(),a||(a=wp.media.frames.direction_image_frame=wp.media({title:cooked_js_vars.i18n_image_title,button:{text:cooked_js_vars.i18n_image_button},library:{type:"image"}})).on("select",function(){var e=a.state().get("selection").first().toJSON();_("#direction-"+d+"-image-src").attr("src",e.sizes.thumbnail.url).parent().addClass("cooked-has-image"),_('input[name="_recipe_settings[directions]['+d+'][image]"]').val(e.id),_('.direction-image-button[data-id="'+d+'"]').prop("value",cooked_js_vars.i18n_image_change)}),a.open()})),$_CookedRecipeGallery.length&&(cooked_init_gallery_sorting(),_("body").on("click",".cooked-gallery-add-button",function(e){_(this);e.preventDefault(),c||(c=wp.media.frames.gallery_images_frame=wp.media({title:cooked_js_vars.i18n_gallery_image_title,button:{text:cooked_js_vars.i18n_gallery_image_title},library:{type:"image"},multiple:!0})).on("select",function(){var e,t,o,i=c.state().get("selection").toJSON();for(e in i)i.hasOwnProperty(e)&&(o=(t=i[e]).sizes.thumbnail.url,_("#cooked-recipe-image-gallery").append('<div data-attachment-id="'+t.id+'" class="cooked-recipe-gallery-item"><img src="'+o+'" /><span class="cooked-gallery-item-title">'+t.title+'</span><input type="hidden" name="_recipe_settings[gallery][items][]" value="'+t.id+'" /><a href="#" data-attachment-id="'+t.id+'" class="cooked-gallery-edit-button"><i class="cooked-icon cooked-icon-pencil"></i></a><a href="#" class="remove-image-button"><i class="cooked-icon cooked-icon-times"></i></a></div>'));cooked_init_gallery_sorting()}),c.open()}),_("body").on("click",".cooked-recipe-gallery-item img",function(e){e.preventDefault(),_(this).parent().find(".cooked-gallery-edit-button").trigger("click")}),_("body").on("click",".cooked-gallery-edit-button",function(e){var n=_(this),t=n.data("attachment-id"),a=(e.preventDefault(),wp.media.frames.gallery_images_frame=wp.media({title:cooked_js_vars.i18n_edit_image_title,button:{text:cooked_js_vars.i18n_edit_image_button},library:{type:"image"},multiple:!1}));a.on("open",function(){var e=a.state().get("selection");(attachment=wp.media.attachment(t)).fetch(),e.add(attachment?[attachment]:[])}),a.open(),a.on("select",function(){var e,t,o,i=a.state().get("selection").toJSON();for(e in i)i.hasOwnProperty(e)&&(o=(t=i[e]).sizes.thumbnail.url,n.parent().replaceWith('<div data-attachment-id="'+t.id+'" class="cooked-recipe-gallery-item"><img src="'+o+'" /><span class="cooked-gallery-item-title">'+t.title+'</span><input type="hidden" name="_recipe_settings[gallery][items][]" value="'+t.id+'" /><a href="#" data-attachment-id="'+t.id+'" class="cooked-gallery-edit-button"><i class="cooked-icon cooked-icon-pencil"></i></a><a href="#" class="remove-image-button"><i class="cooked-icon cooked-icon-times"></i></a></div>'));cooked_init_gallery_sorting()})}),$_CookedRecipeGallery.on("click",".remove-image-button",function(e){var t=_(this);d=t.data("id"),e.preventDefault(),d?(_("#direction-"+d+"-image-src").parent().removeClass("cooked-has-image").prop("src",!1),_('input[name="_recipe_settings[directions]['+d+'][image]"]').val(""),_('.direction-image-button[data-id="'+d+'"]').prop("value",cooked_js_vars.i18n_image_title)):t.parent().remove()})),$_CookedNutritionFactsTab.length&&(init_nutrition_facts($_CookedNutritionFactsTab),$_CookedNutritionFactsTab.on("keyup","input",function(e){init_nutrition_facts($_CookedNutritionFactsTab)})),_("#cooked-prep-time").length&&_("#cooked-prep-time,#cooked-cook-time").on("change",function(){cooked_updateTotalTimeValue(parseInt(_("#cooked-prep-time").val()),parseInt(_("#cooked-cook-time").val()))})})})(jQuery),0);function cooked_set_default_template(e,o,i,n,a){var d,r,c,l;0<o&&(r=jQuery("#cooked-template-progress"),c=r.find(".cooked-progress-bar"),l=jQuery("#cooked-template-progress-text"),r.hasClass("cooked-active")||(r.addClass("cooked-active"),l.addClass("cooked-active"),c.css({width:"0%"}),a.reposition()),jQuery.post(cooked_js_vars.ajax_url,{action:"cooked_save_default_bulk",recipe_ids:e,default_content:i,nonce:n},function(e){var t;e&&"false"!=e&&0!=e?(t=JSON.parse(e),t=Object.keys(t).length,cooked_recipe_update_counter=o-t,d=Math.round(cooked_recipe_update_counter/o*100),c.css({width:d+"%"}),l.text(cooked_recipe_update_counter+" / "+o),cooked_set_default_template(e,o,i,n,a)):(jQuery(".cooked-save-default-all").text(cooked_js_vars.i18n_applied),c.css({width:"100%"}),r.removeClass("cooked-active"),l.removeClass("cooked-active").text(""),a.reposition())}))}function cooked_updateTotalTimeValue(e,t){jQuery("#cooked-total-time").val(e+t)}function cooked_init_gallery_sorting(){jQuery("#cooked-recipe-image-gallery").sortable()}function init_nutrition_facts(e){e.find("input").each(function(){var e,t=jQuery(this),o=t.attr("id"),t=t.val(),i=jQuery('.cooked-nut-percent[data-labeltype="'+o+'"]').length;jQuery('.cooked-nut-label[data-labeltype="'+o+'"]').length&&(t?(jQuery('.cooked-nut-label[data-labeltype="'+o+'"]').text(t),jQuery('.cooked-nut-label[data-labeltype="'+o+'"]').parents("li").eq(0).show(),jQuery('.cooked-nut-label[data-labeltype="'+o+'"]').parents("p").eq(0).show(),i&&(e=(i=jQuery('.cooked-nut-percent[data-labeltype="'+o+'"]')).data("pdv"))&&(thisPercent=Math.ceil(t/e*100),i.text(thisPercent))):(jQuery('.cooked-nut-label[data-labeltype="'+o+'"]').text("___"),jQuery('.cooked-nut-label[data-labeltype="'+o+'"]').parents("li").eq(0).hide(),jQuery('.cooked-nut-label[data-labeltype="'+o+'"]').parents("p").eq(0).hide()))})}function cooked_reset_ingredient_builder(){var e=jQuery(".cooked-ingredient-block"),t=0,i=0,o=!1;0<e.length&&(e.each(function(){var o=cooked_get_random_int(1e7,99999999),e=(i++,jQuery(this));e.hasClass("cooked-ingredient-heading")||t++,e.find("[data-ingredient-part]").each(function(){var e,t=jQuery(this);""==t.attr("name")&&(e=t.data("ingredient-part"),t.attr("name","_recipe_settings[ingredients]["+o+"]["+e+"]"))})}),$_CookedAutoNutritionButton.length)&&jQuery('input[data-ingredient-part="name"]').each(function(){if(""!=jQuery(this).val())return!(o=!0)}),t?(jQuery(".cooked-ingredient-headers").show(),$_CookedAutoNutritionButton.length&&(o?$_CookedAutoNutritionButton.prop("disabled",!1):$_CookedAutoNutritionButton.prop("disabled",!0))):(jQuery(".cooked-ingredient-headers").hide(),$_CookedAutoNutritionButton.length&&$_CookedAutoNutritionButton.prop("disabled",!0)),i?jQuery("#cooked-ingredients-builder").css({"margin-bottom":"20px"}):jQuery("#cooked-ingredients-builder").css({"margin-bottom":"12px"})}function cooked_reset_direction_builder(){var e=jQuery(".cooked-direction-block"),t=0;e.each(function(){var i=cooked_get_random_int(1e7,99999999);t++,jQuery(this).find("[data-direction-part]").each(function(){var e=jQuery(this),t=e.data("direction-part"),o=(""==e.attr("name")&&e.attr("name","_recipe_settings[directions]["+i+"]["+t+"]"),""==e.attr("data-id")&&e.attr("data-id",i),e.attr("id"));""!=o&&null!=o||(t=t.replace("_","-"),e.attr("id",o="direction-"+i+"-"+t),"content"===t&&e.is("textarea")&&cooked_js_vars.wp_editor_roles_allowed&&wp.editor.initialize(o,{tinymce:{wpautop:!1,toolbar1:"bold,italic,underline,blockquote,strikethrough,bullist,numlist,alignleft,aligncenter,alignright,undo,redo,wp_link_advanced,unlink,fullscreen",toolbar2:"",toolbar3:"",toolbar4:"",height:100,textarea_name:"_recipe_settings[directions]["+i+"]["+t+"]",plugins:"link lists fullscreen wordpress wplink",setup:function(e){}},quicktags:!0,mediaButtons:!1}))})}),t?jQuery("#cooked-directions-builder").css({"margin-bottom":"20px"}):jQuery("#cooked-directions-builder").css({"margin-bottom":"12px"})}function cooked_get_random_int(e,t){return Math.floor(Math.random()*(t-e))+e}function cooked_is_int(e){return!(Math.floor(e)!=e||!$.isNumeric(e))}function cooked_init_conditional_field(e){var i=jQuery("#"+e);i.is(":radio")&&jQuery("body").find("input:radio").on("change",function(){i.is(":checked")||jQuery("body").find("[data-condition='"+e+"']").each(function(){jQuery(this).hide()})}),i.on("change",function(){jQuery("#cooked_recipe_settings").addClass("cooked-loading"),window.clearTimeout($_CookedConditionalTimeout),$_CookedConditionalTimeout=window.setTimeout(function(){jQuery("body").find("[data-condition='"+e+"']").each(function(){var e=jQuery(this),t=e.is("li")||e.is("span")?"inline-block":"block",o=!!(o=e.data("value"))&&o.split(" ");i.is(":checkbox")&&i.is(":checked")||i.is(":radio")&&i.is(":checked")||(!i.is(":checkbox")||i.is(":checked"))&&(!i.is(":checkbox")&&!o&&i.val()||!i.is(":checkbox")&&o&&-1<jQuery.inArray(i.val(),o)||!i.is(":radio")&&!o&&i.val()||!i.is(":radio")&&o&&-1<jQuery.inArray(i.val(),o))?e.css({display:t}):e.hide()}),jQuery("#cooked_recipe_settings").removeClass("cooked-loading")},25)})}