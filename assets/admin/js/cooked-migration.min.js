(d=>{d(document).ready(function(){var e=d("#cooked-migration-button"),o=d("#cooked-import-button"),i=d("#cooked-csv-import-button"),r=(d("#cooked-csv-import-form"),d("#cooked-migration-progress"),d("#cooked-migration-progress-text"),d("#cooked-csv-import-progress")),a=d("#cooked-csv-import-progress-text");e.length&&e.on("click",function(e){e.preventDefault();e=d(this);confirm(cooked_migration_js_vars.i18n_confirm_migrate_recipe)&&!e.hasClass("disabled")&&(e.addClass("disabled").attr("disabled",!0),e.hide(),d.post(cooked_migration_js_vars.ajax_url,{action:"cooked_get_migrate_ids"},function(e){var o;e&&(o=JSON.parse(e),0<Object.keys(o).length)&&cooked_migrate_recipes(e,total_recipe)}))}),o.length&&o.on("click",function(e){e.preventDefault();var i=d(this),t=i.data("import-type");confirm(cooked_migration_js_vars.i18n_confirm_import_recipes)&&!i.hasClass("disabled")&&(i.addClass("disabled").attr("disabled",!0),i.hide(),d.post(cooked_migration_js_vars.ajax_url,{action:"cooked_get_import_ids",import_type:t},function(e){var o;e?(o=JSON.parse(e),0<(o=Object.keys(o).length)&&cooked_import_recipes(e,o,t)):(console.log(cooked_migration_js_vars.i18n_something_wrong),i.addClass("disabled").attr("disabled",!1),i.show())}))}),i.length&&i.on("click",function(e){e.preventDefault();var o,i=d(this),t=d("#cooked-csv-file"),e=t[0].files[0],s=d("#cooked-csv-import-errors");s.hide().empty(),e?"text/csv"===e.type||e.name.endsWith(".csv")?i.hasClass("disabled")||confirm(cooked_migration_js_vars.i18n_confirm_csv_import)&&(i.addClass("disabled").attr("disabled",!0),t.attr("disabled",!0),(o=new FormData).append("action","cooked_upload_csv"),o.append("csv_file",e),r.hasClass("cooked-active")||(r.addClass("cooked-active"),a.addClass("cooked-active"),r.find(".cooked-progress-bar").css({width:"0%"}),a.text(cooked_migration_js_vars.i18n_uploading)),d.ajax({url:cooked_migration_js_vars.ajax_url,type:"POST",data:o,processData:!1,contentType:!1,success:function(e){e.success?(a.text(cooked_migration_js_vars.i18n_processing),r.find(".cooked-progress-bar").css({width:"50%"}),d.post(cooked_migration_js_vars.ajax_url,{action:"cooked_process_csv",transient_key:e.data.transient_key},function(e){var o;e.success?(r.find(".cooked-progress-bar").css({width:"100%"}),a.text(e.data.success+" / "+e.data.total+" "+cooked_migration_js_vars.i18n_recipes_imported),e.data.errors&&0<e.data.errors.length&&(o="<p><strong>"+cooked_migration_js_vars.i18n_errors+"</strong></p><ul>",e.data.errors.forEach(function(e){o+="<li>"+e+"</li>"}),o+="</ul>",s.html(o).show()),setTimeout(function(){r.hide(),a.hide(),d("#cooked-csv-import-completed").show(),i.hide(),t.hide()},2e3)):(s.html("<p>"+(e.data.message||cooked_migration_js_vars.i18n_import_failed)+"</p>").show(),i.removeClass("disabled").attr("disabled",!1),t.attr("disabled",!1),r.removeClass("cooked-active"),a.removeClass("cooked-active"))},"json").fail(function(){s.html("<p>"+cooked_migration_js_vars.i18n_failed_process_csv+"</p>").show(),i.removeClass("disabled").attr("disabled",!1),t.attr("disabled",!1),r.removeClass("cooked-active"),a.removeClass("cooked-active")})):(s.html("<p>"+(e.data.message||cooked_migration_js_vars.i18n_file_upload_failed)+"</p>").show(),i.removeClass("disabled").attr("disabled",!1),t.attr("disabled",!1),r.removeClass("cooked-active"),a.removeClass("cooked-active"))},error:function(){s.html("<p>"+cooked_migration_js_vars.i18n_failed_upload_csv+"</p>").show(),i.removeClass("disabled").attr("disabled",!1),t.attr("disabled",!1),r.removeClass("cooked-active"),a.removeClass("cooked-active")}})):s.html("<p>"+cooked_migration_js_vars.i18n_csv_invalid_file+"</p>").show():s.html("<p>"+cooked_migration_js_vars.i18n_csv_no_file+"</p>").show()})})})(jQuery);{function cookedDecimalAdjust(e,o,i){return void 0===i||0==+i?Math[e](o):(i=+i,null===(o=+o)||isNaN(o)||"number"!=typeof i||i%1!=0?NaN:o<0?-cookedDecimalAdjust(e,-o,i):(o=o.toString().split("e"),+((o=(o=Math[e](+(o[0]+"e"+(o[1]?+o[1]-i:-i)))).toString().split("e"))[0]+"e"+(o[1]?+o[1]+i:i))))}}Math.round10||(Math.round10=function(e,o){return cookedDecimalAdjust("round",e,o)});var cooked_recipe_migrate_counter=0,progressIterations=0;function cooked_migrate_recipes(e,r){var a,d,c,o,n=0;0<r&&(a=jQuery("#cooked-migration-progress"),d=a.find(".cooked-progress-bar"),c=jQuery("#cooked-migration-progress-text"),a.hasClass("cooked-active")||(a.addClass("cooked-active"),c.addClass("cooked-active"),d.css({width:"0%"})),o=JSON.parse(e),Object.keys(o).length,r.toLocaleString(),jQuery.post(cooked_migration_js_vars.ajax_url,{action:"cooked_migrate_recipes",recipe_ids:e},function(e){var o,i,t,s;e&&"false"!=e&&0!=e?(o=JSON.parse(e),o=Object.keys(o).length,cooked_recipe_migrate_counter=r-o,(o=r).toLocaleString(),(i=cooked_recipe_migrate_counter).toLocaleString(),(n=Math.round10(cooked_recipe_migrate_counter/r*100,-1))<2&&(n=2),d.css({width:n+"%"}),s=100-n,s=Math.round(s/n*progressIterations),progressIterations+=1,n<100&&3<n&&isFinite(s)?(t=Math.floor(s/3600),s=Math.floor(s/60%60),1<=t?c.html(i+" / "+o+"<strong style='display:inline-block; float:right;'>"+t+" "+cooked_migration_js_vars.i18n_hrs+", "+s+" "+cooked_migration_js_vars.i18n_mins+" "+cooked_migration_js_vars.i18n_remaining+"</strong>"):1<=s?c.html(i+" / "+o+"<strong style='display:inline-block; float:right;'>"+s+" "+cooked_migration_js_vars.i18n_mins+" "+cooked_migration_js_vars.i18n_remaining+"</strong>"):c.text(i+" / "+o)):c.text(i+" / "+o),cooked_migrate_recipes(e,r)):(a.hide(),c.hide(),jQuery(".recipe-setting-block.migrate_button").find("h3").hide(),jQuery(".recipe-setting-block.migrate_button").find("p:nth-child(2)").hide(),jQuery(".recipe-setting-block.migrate_button").find("ul.cooked-admin-ul").hide(),jQuery("#cooked-migration-button").hide(),jQuery("#cooked-migration-completed").addClass("cooked-active"))}))}function cooked_import_recipes(e,r,a){var d,c,n,o,_=0;0<r&&(d=jQuery("#cooked-import-progress"),c=d.find(".cooked-progress-bar"),n=jQuery("#cooked-import-progress-text"),d.hasClass("cooked-active")||(d.addClass("cooked-active"),n.addClass("cooked-active"),c.css({width:"0%"})),o=JSON.parse(e),Object.keys(o).length,r.toLocaleString(),jQuery.post(cooked_migration_js_vars.ajax_url,{action:"cooked_import_recipes",recipe_ids:e,import_type:a},function(e){var o,i,t,s;e&&"false"!=e&&0!=e?(o=JSON.parse(e),o=Object.keys(o).length,cooked_recipe_migrate_counter=r-o,(o=r).toLocaleString(),(i=cooked_recipe_migrate_counter).toLocaleString(),(_=Math.round10(cooked_recipe_migrate_counter/r*100,-1))<2&&(_=2),c.css({width:_+"%"}),s=100-_,s=Math.round(s/_*progressIterations),progressIterations+=1,_<100&&3<_&&isFinite(s)?(t=Math.floor(s/3600),s=Math.floor(s/60%60),1<=t?n.html(i+" / "+o+"<strong style='display:inline-block; float:right;'>"+t+" "+cooked_migration_js_vars.i18n_hrs+", "+s+" "+cooked_migration_js_vars.i18n_mins+" "+cooked_migration_js_vars.i18n_remaining+"</strong>"):1<=s?n.html(i+" / "+o+"<strong style='display:inline-block; float:right;'>"+s+" "+cooked_migration_js_vars.i18n_mins+" "+cooked_migration_js_vars.i18n_remaining+"</strong>"):n.text(i+" / "+o)):n.text(i+" / "+o),cooked_import_recipes(e,r,a)):(d.hide(),n.hide(),jQuery(".recipe-setting-block.import_button").find("h3").hide(),jQuery(".recipe-setting-block.import_button").find("p:nth-child(2)").hide(),jQuery(".recipe-setting-block.import_button").find(".cooked-import-note").hide(),jQuery(".recipe-setting-block.import_button").find("ul.cooked-admin-ul").hide(),jQuery("#cooked-import-button").hide(),jQuery("#cooked-import-completed").addClass("cooked-active"))}))}