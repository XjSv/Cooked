(c=>{c(document).ready(function(){var e=c("#cooked-migration-button"),o=c("#cooked-import-button"),i=c("#cooked-csv-import-button"),a=(c("#cooked-csv-import-form"),c("#cooked-migration-progress"),c("#cooked-migration-progress-text"),c("#cooked-csv-import-progress")),d=c("#cooked-csv-import-progress-text");e.length&&e.on("click",function(e){e.preventDefault();e=c(this);confirm(cooked_migration_js_vars.i18n_confirm_migrate_recipe)&&!e.hasClass("disabled")&&(e.addClass("disabled").attr("disabled",!0),e.hide(),c.post(cooked_migration_js_vars.ajax_url,{action:"cooked_get_migrate_ids"},function(e){var o;e&&(o=JSON.parse(e),0<Object.keys(o).length)&&cooked_migrate_recipes(e,total_recipe)}))}),o.length&&o.on("click",function(e){e.preventDefault();var i=c(this),t=i.data("import-type");confirm(cooked_migration_js_vars.i18n_confirm_import_recipes)&&!i.hasClass("disabled")&&(i.addClass("disabled").attr("disabled",!0),i.hide(),c.post(cooked_migration_js_vars.ajax_url,{action:"cooked_get_import_ids",import_type:t},function(e){var o;e?(o=JSON.parse(e),0<(o=Object.keys(o).length)&&cooked_import_recipes(e,o,t)):(console.log(cooked_migration_js_vars.i18n_something_wrong||"Something went wrong"),i.addClass("disabled").attr("disabled",!1),i.show())}))}),i.length&&i.on("click",function(e){e.preventDefault();var o,t=c(this),r=c("#cooked-csv-file"),e=r[0].files[0],s=c("#cooked-csv-import-errors");s.hide().empty(),e?"text/csv"===e.type||e.name.endsWith(".csv")?t.hasClass("disabled")||confirm(cooked_migration_js_vars.i18n_confirm_csv_import||cooked_migration_js_vars.i18n_confirm_import_recipes||"Are you sure you want to import recipes from this CSV file?")&&(t.addClass("disabled").attr("disabled",!0),r.attr("disabled",!0),(o=new FormData).append("action","cooked_upload_csv"),o.append("csv_file",e),a.hasClass("cooked-active")||(a.addClass("cooked-active"),d.addClass("cooked-active"),a.find(".cooked-progress-bar").css({width:"0%"}),d.text(cooked_migration_js_vars.i18n_uploading||"Uploading...")),c.ajax({url:cooked_migration_js_vars.ajax_url,type:"POST",data:o,processData:!1,contentType:!1,success:function(e){var o;e.success?(d.text(cooked_migration_js_vars.i18n_processing||"Processing..."),a.find(".cooked-progress-bar").css({width:"50%"}),c.post(cooked_migration_js_vars.ajax_url,{action:"cooked_process_csv",transient_key:e.data.transient_key},function(e){var o,i;e.success?(a.find(".cooked-progress-bar").css({width:"100%"}),o=cooked_migration_js_vars.i18n_recipes_imported||"recipes imported",d.text(e.data.success+" / "+e.data.total+" "+o),e.data.errors&&0<e.data.errors.length&&(i="<p><strong>"+(cooked_migration_js_vars.i18n_errors||"Errors:")+"</strong></p><ul>",e.data.errors.forEach(function(e){i+="<li>"+e+"</li>"}),i+="</ul>",s.html(i).show()),setTimeout(function(){a.hide(),d.hide(),c("#cooked-csv-import-completed").show(),t.hide(),r.hide()},2e3)):(o=cooked_migration_js_vars.i18n_import_failed||"Import failed.",s.html("<p>"+(e.data.message||o)+"</p>").show(),e.data.errors&&0<e.data.errors.length&&(i="<ul>",e.data.errors.forEach(function(e){i+="<li>"+e+"</li>"}),i+="</ul>",s.append(i)),t.removeClass("disabled").attr("disabled",!1),r.attr("disabled",!1),a.removeClass("cooked-active"),d.removeClass("cooked-active"))},"json").fail(function(){var e=cooked_migration_js_vars.i18n_failed_process_csv||"Failed to process CSV file.";s.html("<p>"+e+"</p>").show(),t.removeClass("disabled").attr("disabled",!1),r.attr("disabled",!1),a.removeClass("cooked-active"),d.removeClass("cooked-active")})):(o=cooked_migration_js_vars.i18n_file_upload_failed||"File upload failed.",s.html("<p>"+(e.data.message||o)+"</p>").show(),t.removeClass("disabled").attr("disabled",!1),r.attr("disabled",!1),a.removeClass("cooked-active"),d.removeClass("cooked-active"))},error:function(){var e=cooked_migration_js_vars.i18n_failed_upload_csv||"Failed to upload CSV file.";s.html("<p>"+e+"</p>").show(),t.removeClass("disabled").attr("disabled",!1),r.attr("disabled",!1),a.removeClass("cooked-active"),d.removeClass("cooked-active")}})):(e=cooked_migration_js_vars.i18n_csv_invalid_file||"Please select a valid CSV file.",s.html("<p>"+e+"</p>").show()):(o=cooked_migration_js_vars.i18n_csv_no_file||"Please select a CSV file.",s.html("<p>"+o+"</p>").show())})})})(jQuery);{function cookedDecimalAdjust(e,o,i){return void 0===i||0==+i?Math[e](o):(i=+i,null===(o=+o)||isNaN(o)||"number"!=typeof i||i%1!=0?NaN:o<0?-cookedDecimalAdjust(e,-o,i):(o=o.toString().split("e"),+((o=(o=Math[e](+(o[0]+"e"+(o[1]?+o[1]-i:-i)))).toString().split("e"))[0]+"e"+(o[1]?+o[1]+i:i))))}}Math.round10||(Math.round10=function(e,o){return cookedDecimalAdjust("round",e,o)});var cooked_recipe_migrate_counter=0,progressIterations=0;function cooked_migrate_recipes(e,d){var c,n,_,o,l=0;0<d&&(c=jQuery("#cooked-migration-progress"),n=c.find(".cooked-progress-bar"),_=jQuery("#cooked-migration-progress-text"),c.hasClass("cooked-active")||(c.addClass("cooked-active"),_.addClass("cooked-active"),n.css({width:"0%"})),o=JSON.parse(e),Object.keys(o).length,d.toLocaleString(),jQuery.post(cooked_migration_js_vars.ajax_url,{action:"cooked_migrate_recipes",recipe_ids:e},function(e){var o,i,t,r,s,a;e&&"false"!=e&&0!=e?(o=JSON.parse(e),o=Object.keys(o).length,cooked_recipe_migrate_counter=d-o,(o=d).toLocaleString(),(i=cooked_recipe_migrate_counter).toLocaleString(),(l=Math.round10(cooked_recipe_migrate_counter/d*100,-1))<2&&(l=2),n.css({width:l+"%"}),r=100-l,r=Math.round(r/l*progressIterations),progressIterations+=1,l<100&&3<l&&isFinite(r)?(t=Math.floor(r/3600),r=Math.floor(r/60%60),s=cooked_migration_js_vars.i18n_hrs||"hrs",a=cooked_migration_js_vars.i18n_mins||"mins",1<=t?_.html(i+" / "+o+"<strong style='display:inline-block; float:right;'>"+t+" "+s+", "+r+" "+a+" "+cooked_migration_js_vars.i18n_remaining+"</strong>"):1<=r?_.html(i+" / "+o+"<strong style='display:inline-block; float:right;'>"+r+" "+a+" "+cooked_migration_js_vars.i18n_remaining+"</strong>"):_.text(i+" / "+o)):_.text(i+" / "+o),cooked_migrate_recipes(e,d)):(c.hide(),_.hide(),jQuery(".recipe-setting-block.migrate_button").find("h3").hide(),jQuery(".recipe-setting-block.migrate_button").find("p:nth-child(2)").hide(),jQuery(".recipe-setting-block.migrate_button").find("ul.cooked-admin-ul").hide(),jQuery("#cooked-migration-button").hide(),jQuery("#cooked-migration-completed").addClass("cooked-active"))}))}function cooked_import_recipes(e,d,c){var n,_,l,o,p=0;0<d&&(n=jQuery("#cooked-import-progress"),_=n.find(".cooked-progress-bar"),l=jQuery("#cooked-import-progress-text"),n.hasClass("cooked-active")||(n.addClass("cooked-active"),l.addClass("cooked-active"),_.css({width:"0%"})),o=JSON.parse(e),Object.keys(o).length,d.toLocaleString(),jQuery.post(cooked_migration_js_vars.ajax_url,{action:"cooked_import_recipes",recipe_ids:e,import_type:c},function(e){var o,i,t,r,s,a;e&&"false"!=e&&0!=e?(o=JSON.parse(e),o=Object.keys(o).length,cooked_recipe_migrate_counter=d-o,(o=d).toLocaleString(),(i=cooked_recipe_migrate_counter).toLocaleString(),(p=Math.round10(cooked_recipe_migrate_counter/d*100,-1))<2&&(p=2),_.css({width:p+"%"}),r=100-p,r=Math.round(r/p*progressIterations),progressIterations+=1,p<100&&3<p&&isFinite(r)?(t=Math.floor(r/3600),r=Math.floor(r/60%60),s=cooked_migration_js_vars.i18n_hrs||"hrs",a=cooked_migration_js_vars.i18n_mins||"mins",1<=t?l.html(i+" / "+o+"<strong style='display:inline-block; float:right;'>"+t+" "+s+", "+r+" "+a+" "+cooked_migration_js_vars.i18n_remaining+"</strong>"):1<=r?l.html(i+" / "+o+"<strong style='display:inline-block; float:right;'>"+r+" "+a+" "+cooked_migration_js_vars.i18n_remaining+"</strong>"):l.text(i+" / "+o)):l.text(i+" / "+o),cooked_import_recipes(e,d,c)):(n.hide(),l.hide(),jQuery(".recipe-setting-block.import_button").find("h3").hide(),jQuery(".recipe-setting-block.import_button").find("p:nth-child(2)").hide(),jQuery(".recipe-setting-block.import_button").find(".cooked-import-note").hide(),jQuery(".recipe-setting-block.import_button").find("ul.cooked-admin-ul").hide(),jQuery("#cooked-import-button").hide(),jQuery("#cooked-import-completed").addClass("cooked-active"))}))}