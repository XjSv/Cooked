(d=>{d(document).ready(function(){var e=d("#cooked-migration-button"),o=d("#cooked-import-button"),t=d("#cooked-csv-import-button"),r=(d("#cooked-csv-import-form"),d("#cooked-migration-progress"),d("#cooked-migration-progress-text"),d("#cooked-csv-import-progress")),a=d("#cooked-csv-import-progress-text");e.length&&e.on("click",function(e){e.preventDefault();e=d(this);confirm(cooked_migration_js_vars.i18n_confirm_migrate_recipe)&&!e.hasClass("disabled")&&(e.addClass("disabled").attr("disabled",!0),e.hide(),d.post(cooked_migration_js_vars.ajax_url,{action:"cooked_get_migrate_ids"},function(e){var o;e&&(o=JSON.parse(e),0<Object.keys(o).length)&&cooked_migrate_recipes(e,total_recipe)}))}),o.length&&o.on("click",function(e){e.preventDefault();var t=d(this),i=t.data("import-type");confirm(cooked_migration_js_vars.i18n_confirm_import_recipes)&&!t.hasClass("disabled")&&(t.addClass("disabled").attr("disabled",!0),t.hide(),d.post(cooked_migration_js_vars.ajax_url,{action:"cooked_get_import_ids",import_type:i},function(e){var o;e?(o=JSON.parse(e),0<(o=Object.keys(o).length)&&cooked_import_recipes(e,o,i)):(console.log(cooked_migration_js_vars.i18n_something_wrong||"Something went wrong"),t.addClass("disabled").attr("disabled",!1),t.show())}))}),t.length&&t.on("click",function(e){e.preventDefault();var o,t=d(this),i=d("#cooked-csv-file"),e=i[0].files[0],s=d("#cooked-csv-import-errors");s.hide().empty(),e?"text/csv"===e.type||e.name.endsWith(".csv")?t.hasClass("disabled")||confirm(cooked_migration_js_vars.i18n_confirm_csv_import)&&(t.addClass("disabled").attr("disabled",!0),i.attr("disabled",!0),(o=new FormData).append("action","cooked_upload_csv"),o.append("csv_file",e),r.hasClass("cooked-active")||(r.addClass("cooked-active"),a.addClass("cooked-active"),r.find(".cooked-progress-bar").css({width:"0%"}),a.text(cooked_migration_js_vars.i18n_uploading)),d.ajax({url:cooked_migration_js_vars.ajax_url,type:"POST",data:o,processData:!1,contentType:!1,success:function(e){e.success?(a.text(cooked_migration_js_vars.i18n_processing),r.find(".cooked-progress-bar").css({width:"50%"}),d.post(cooked_migration_js_vars.ajax_url,{action:"cooked_process_csv",transient_key:e.data.transient_key},function(e){var o;e.success?(r.find(".cooked-progress-bar").css({width:"100%"}),a.text(e.data.success+" / "+e.data.total+" "+cooked_migration_js_vars.i18n_recipes_imported),e.data.errors&&0<e.data.errors.length&&(o="<p><strong>"+cooked_migration_js_vars.i18n_errors+"</strong></p><ul>",e.data.errors.forEach(function(e){o+="<li>"+e+"</li>"}),o+="</ul>",s.html(o).show()),setTimeout(function(){r.hide(),a.hide(),d("#cooked-csv-import-completed").show(),t.hide(),i.hide()},2e3)):(s.html("<p>"+(e.data.message||cooked_migration_js_vars.i18n_import_failed)+"</p>").show(),t.removeClass("disabled").attr("disabled",!1),i.attr("disabled",!1),r.removeClass("cooked-active"),a.removeClass("cooked-active"))},"json").fail(function(){s.html("<p>"+cooked_migration_js_vars.i18n_failed_process_csv+"</p>").show(),t.removeClass("disabled").attr("disabled",!1),i.attr("disabled",!1),r.removeClass("cooked-active"),a.removeClass("cooked-active")})):(s.html("<p>"+(e.data.message||cooked_migration_js_vars.i18n_file_upload_failed)+"</p>").show(),t.removeClass("disabled").attr("disabled",!1),i.attr("disabled",!1),r.removeClass("cooked-active"),a.removeClass("cooked-active"))},error:function(){s.html("<p>"+cooked_migration_js_vars.i18n_failed_upload_csv+"</p>").show(),t.removeClass("disabled").attr("disabled",!1),i.attr("disabled",!1),r.removeClass("cooked-active"),a.removeClass("cooked-active")}})):s.html("<p>"+cooked_migration_js_vars.i18n_csv_invalid_file+"</p>").show():s.html("<p>"+cooked_migration_js_vars.i18n_csv_no_file+"</p>").show()})})})(jQuery);{function cookedDecimalAdjust(e,o,t){return void 0===t||0==+t?Math[e](o):(t=+t,null===(o=+o)||isNaN(o)||"number"!=typeof t||t%1!=0?NaN:o<0?-cookedDecimalAdjust(e,-o,t):(o=o.toString().split("e"),+((o=(o=Math[e](+(o[0]+"e"+(o[1]?+o[1]-t:-t)))).toString().split("e"))[0]+"e"+(o[1]?+o[1]+t:t))))}}Math.round10||(Math.round10=function(e,o){return cookedDecimalAdjust("round",e,o)});var cooked_recipe_migrate_counter=0,progressIterations=0;function cooked_migrate_recipes(e,d){var c,n,_,o,l=0;0<d&&(c=jQuery("#cooked-migration-progress"),n=c.find(".cooked-progress-bar"),_=jQuery("#cooked-migration-progress-text"),c.hasClass("cooked-active")||(c.addClass("cooked-active"),_.addClass("cooked-active"),n.css({width:"0%"})),o=JSON.parse(e),Object.keys(o).length,d.toLocaleString(),jQuery.post(cooked_migration_js_vars.ajax_url,{action:"cooked_migrate_recipes",recipe_ids:e},function(e){var o,t,i,s,r,a;e&&"false"!=e&&0!=e?(o=JSON.parse(e),o=Object.keys(o).length,cooked_recipe_migrate_counter=d-o,(o=d).toLocaleString(),(t=cooked_recipe_migrate_counter).toLocaleString(),(l=Math.round10(cooked_recipe_migrate_counter/d*100,-1))<2&&(l=2),n.css({width:l+"%"}),s=100-l,s=Math.round(s/l*progressIterations),progressIterations+=1,l<100&&3<l&&isFinite(s)?(i=Math.floor(s/3600),s=Math.floor(s/60%60),r=cooked_migration_js_vars.i18n_hrs||"hrs",a=cooked_migration_js_vars.i18n_mins||"mins",1<=i?_.html(t+" / "+o+"<strong style='display:inline-block; float:right;'>"+i+" "+r+", "+s+" "+a+" "+cooked_migration_js_vars.i18n_remaining+"</strong>"):1<=s?_.html(t+" / "+o+"<strong style='display:inline-block; float:right;'>"+s+" "+a+" "+cooked_migration_js_vars.i18n_remaining+"</strong>"):_.text(t+" / "+o)):_.text(t+" / "+o),cooked_migrate_recipes(e,d)):(c.hide(),_.hide(),jQuery(".recipe-setting-block.migrate_button").find("h3").hide(),jQuery(".recipe-setting-block.migrate_button").find("p:nth-child(2)").hide(),jQuery(".recipe-setting-block.migrate_button").find("ul.cooked-admin-ul").hide(),jQuery("#cooked-migration-button").hide(),jQuery("#cooked-migration-completed").addClass("cooked-active"))}))}function cooked_import_recipes(e,d,c){var n,_,l,o,m=0;0<d&&(n=jQuery("#cooked-import-progress"),_=n.find(".cooked-progress-bar"),l=jQuery("#cooked-import-progress-text"),n.hasClass("cooked-active")||(n.addClass("cooked-active"),l.addClass("cooked-active"),_.css({width:"0%"})),o=JSON.parse(e),Object.keys(o).length,d.toLocaleString(),jQuery.post(cooked_migration_js_vars.ajax_url,{action:"cooked_import_recipes",recipe_ids:e,import_type:c},function(e){var o,t,i,s,r,a;e&&"false"!=e&&0!=e?(o=JSON.parse(e),o=Object.keys(o).length,cooked_recipe_migrate_counter=d-o,(o=d).toLocaleString(),(t=cooked_recipe_migrate_counter).toLocaleString(),(m=Math.round10(cooked_recipe_migrate_counter/d*100,-1))<2&&(m=2),_.css({width:m+"%"}),s=100-m,s=Math.round(s/m*progressIterations),progressIterations+=1,m<100&&3<m&&isFinite(s)?(i=Math.floor(s/3600),s=Math.floor(s/60%60),r=cooked_migration_js_vars.i18n_hrs||"hrs",a=cooked_migration_js_vars.i18n_mins||"mins",1<=i?l.html(t+" / "+o+"<strong style='display:inline-block; float:right;'>"+i+" "+r+", "+s+" "+a+" "+cooked_migration_js_vars.i18n_remaining+"</strong>"):1<=s?l.html(t+" / "+o+"<strong style='display:inline-block; float:right;'>"+s+" "+a+" "+cooked_migration_js_vars.i18n_remaining+"</strong>"):l.text(t+" / "+o)):l.text(t+" / "+o),cooked_import_recipes(e,d,c)):(n.hide(),l.hide(),jQuery(".recipe-setting-block.import_button").find("h3").hide(),jQuery(".recipe-setting-block.import_button").find("p:nth-child(2)").hide(),jQuery(".recipe-setting-block.import_button").find(".cooked-import-note").hide(),jQuery(".recipe-setting-block.import_button").find("ul.cooked-admin-ul").hide(),jQuery("#cooked-import-button").hide(),jQuery("#cooked-import-completed").addClass("cooked-active"))}))}